<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TestStore</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
  <div class="container">
    <h1 class="text-center">Order History</h1>
    <hr>
    <div class="text-center">
      <a class="btn btn-primary" href="/create-account">Create Account</a>
      <a class="btn btn-outline-primary" href="/login">Login</a>
      <a class="btn btn-outline-primary" href="/crud">Product CRUD</a>
      <a class="btn btn-primary" href="/cart">Shopping Cart</a>
    </div>
    <hr>
		<table class="table">
			<thead>
				
			</thead>
			<tbody>
				<div th:each="order,iterStat : ${orders}">
					<td>
						<h3 th:text="@{${iterStat.index + 1} + 'Â° Order'}"></h3>
					</td>
					<td th:text="${order.createdAt.toString.substring(0,10)}"></td>
					<tr th:each="index,iterStat : ${order.productList}">
						<td>
							<img th:src="@{'images/' + ${products.findById(index).get().imageName}}" alt="..."
							width="100">
						</td>
						<td th:text="${products.findById(index).get().name}"></td>
						<td th:text="@{${order.productQuantity.get(iterStat.index)} + 'x'}"></td>
						<td th:text="@{${products.findById(index).get().price} + '$'}"></td>
						<td th:with="price = ${products.findById(index).get().price},
							quantity = ${order.productQuantity.get(iterStat.index)},
							total = ${price * quantity}"
							th:text="${total}"></td>
					</tr>
				</div>
			</tbody>
		</table>
        
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>